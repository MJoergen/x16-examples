10 XS=40
20 YS=30

100 PRINT CHR$(147)
110 FOR X=0 TO XS-1
120 VPOKE 0, 0*256+X*2+1, 1*16+1
125 VPOKE 0, (YS-1)*256+X*2+1, 1*16+1
130 NEXT
140 FOR Y=0 TO YS-1
150 VPOKE 0, Y*256+0*2+1, 1*16+1
155 VPOKE 0, Y*256+(XS-1)*2+1, 1*16+1
160 NEXT

200 REM START IN THE MIDDLE
210 X=XS/2
220 Y=YS/2

300 REM ARE WE FINISHED?
310 IF VPEEK(0, Y*256+X*2+1)<>6*16+1 THEN GOTO 900

400 REM IS THIS PIXEL CONNECTED?
410 A = VPEEK(0, Y*256+(X-1)*2+1)
420 IF A<>6*16+1 THEN GOTO 700
430 A = VPEEK(0, Y*256+(X+1)*2+1)
440 IF A<>6*16+1 THEN GOTO 700
450 A = VPEEK(0, (Y-1)*256+X*2+1)
460 IF A<>6*16+1 THEN GOTO 700
470 A = VPEEK(0, (Y+1)*256+X*2+1)
480 IF A<>6*16+1 THEN GOTO 700

500 REM MOVE PIXEL
510 NX=X
520 NY=Y
530 D=INT(RND(0)*2)*2 + INT(RND(0)*2)
540 IF D=0 THEN NX=X+1
550 IF D=1 THEN NX=X-1
560 IF D=2 THEN NY=Y+1
570 IF D=3 THEN NY=Y-1
580 VPOKE 0, NY*256+NX*2+1, 7*16+1
590 VPOKE 0, Y*256+X*2+1, 6*16+1
600 X=NX
610 Y=NY
620 GOTO 400

700 REM DETERMINE COLOUR OF PIXEL
710 IF X>1 AND X<XS-2 AND Y>1 AND Y<YS-2 THEN GOTO 800
720 D=INT(RND(0)*16)
730 IF D=0 OR D=1 OR D=6 THEN GOTO 720
740 A=D*16+1

800 VPOKE 0, Y*256+X*2+1, A
810 GOTO 200

900 REM INFINITE LOOP!
910 GOTO 900

